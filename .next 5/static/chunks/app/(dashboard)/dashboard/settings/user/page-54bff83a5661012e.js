(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1819],{2658:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var r=a(5155),s=a(2115),n=a(6648),l=a(6948),i=a(3998),c=a(5142),d=a(6444),o=a(8927),x=a(2619),u=a.n(x),m=a(3479),f=a(7910),h=a(9715),p=a(9867),j=a(1360),b=a(2056);function g(){let[e,t]=(0,s.useState)(null),[a,n]=(0,s.useState)([]),[c,d]=(0,s.useState)(!0),[o,x]=(0,s.useState)(null),[g,y]=(0,s.useState)(null),[v,N]=(0,s.useState)(!1);(0,s.useEffect)(()=>{w()},[]);let w=async()=>{try{let[e,a]=await Promise.all([fetch("/api/user/gdpr/delete-request"),fetch("/api/user/gdpr/export")]);if(e.ok){let a=await e.json();t(a.deletionRequest)}if(a.ok){let e=await a.json();n(e.exportRequests||[])}}catch(e){console.error("Error loading GDPR data:",e)}finally{d(!1)}},k=async()=>{x("delete"),y(null);try{let e=await fetch("/api/user/gdpr/delete-request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:"User requested account deletion"})}),a=await e.json();if(!e.ok)throw Error(a.error||"Failed to request deletion");t(a.deletionRequest),y({type:"success",text:"Account deletion request created. Your account will be deleted in 30 days."}),N(!1)}catch(e){y({type:"error",text:e instanceof Error?e.message:"Failed to request deletion"})}finally{x(null)}},C=async()=>{if(null==e?void 0:e.confirmationToken){x("confirm"),y(null);try{let a=await fetch("/api/user/gdpr/delete-request/".concat(e.confirmationToken,"/confirm"),{method:"POST"}),r=await a.json();if(!a.ok)throw Error(r.error||"Failed to confirm deletion");t(r.deletionRequest),y({type:"success",text:"Deletion confirmed. Your account will be deleted on the scheduled date."})}catch(e){y({type:"error",text:e instanceof Error?e.message:"Failed to confirm deletion"})}finally{x(null)}}},S=async()=>{if(null==e?void 0:e.confirmationToken){x("cancel"),y(null);try{let a=await fetch("/api/user/gdpr/delete-request/".concat(e.confirmationToken,"/cancel"),{method:"POST"}),r=await a.json();if(!a.ok)throw Error(r.error||"Failed to cancel deletion");t(null),y({type:"success",text:"Deletion request cancelled successfully."})}catch(e){y({type:"error",text:e instanceof Error?e.message:"Failed to cancel deletion"})}finally{x(null)}}},D=async()=>{x("export"),y(null);try{let e=await fetch("/api/user/gdpr/export",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({includeProfile:!0,includeCompanies:!0,includeAssessments:!0,includeDocuments:!1})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to request export");await w(),y({type:"success",text:"Data export created successfully."})}catch(e){y({type:"error",text:e instanceof Error?e.message:"Failed to request export"})}finally{x(null)}},E=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return c?(0,r.jsxs)(l.Zp,{children:[(0,r.jsx)(l.aR,{children:(0,r.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(f.A,{className:"h-5 w-5","aria-hidden":"true"}),"Privacy & Data"]})}),(0,r.jsx)(l.Wu,{children:(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})})})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(h.A,{className:"h-5 w-5","aria-hidden":"true"}),"Privacy Documents"]}),(0,r.jsx)(l.BT,{children:"Review our privacy policy and terms of service"})]}),(0,r.jsx)(l.Wu,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,r.jsx)(u(),{href:"/privacy",children:(0,r.jsx)(i.$,{variant:"outline",children:"Privacy Policy"})}),(0,r.jsx)(u(),{href:"/terms",children:(0,r.jsx)(i.$,{variant:"outline",children:"Terms of Service"})})]})})]}),(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsx)(l.ZB,{children:"Cookie Preferences"}),(0,r.jsx)(l.BT,{children:"Manage your cookie consent settings"})]}),(0,r.jsx)(l.Wu,{children:(0,r.jsx)(m.a9,{})})]}),(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(p.A,{className:"h-5 w-5","aria-hidden":"true"}),"Export Your Data"]}),(0,r.jsx)(l.BT,{children:"Download a copy of all your data (GDPR Article 20 - Right to Data Portability)"})]}),(0,r.jsxs)(l.Wu,{className:"space-y-4",children:[(0,r.jsxs)(i.$,{onClick:D,disabled:"export"===o,className:"gap-2",children:[(0,r.jsx)(p.A,{className:"h-4 w-4","aria-hidden":"true"}),"export"===o?"Creating Export...":"Request Data Export"]}),a.length>0&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Recent Exports"}),(0,r.jsx)("div",{className:"space-y-2",children:a.map(e=>{var t;return(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:E(e.requestedAt)}),(0,r.jsxs)("span",{className:"text-gray-500 ml-2",children:["(",e.status,")",e.fileSize&&" - ".concat((t=e.fileSize)<1024?"".concat(t," B"):t<1048576?"".concat((t/1024).toFixed(1)," KB"):"".concat((t/1048576).toFixed(1)," MB"))]})]}),"READY"===e.status&&e.downloadToken&&(0,r.jsx)("a",{href:"/api/user/gdpr/export/".concat(e.downloadToken,"/download"),className:"text-primary hover:underline",children:"Download"})]},e.id)})})]})]})]}),(0,r.jsxs)(l.Zp,{className:"border-destructive/50",children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsxs)(l.ZB,{className:"flex items-center gap-2 text-destructive",children:[(0,r.jsx)(j.A,{className:"h-5 w-5","aria-hidden":"true"}),"Delete Account"]}),(0,r.jsx)(l.BT,{children:"Permanently delete your account and all associated data (GDPR Article 17 - Right to Erasure)"})]}),(0,r.jsx)(l.Wu,{className:"space-y-4",children:e?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(b.A,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5","aria-hidden":"true"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-amber-800",children:"Deletion Scheduled"}),(0,r.jsxs)("p",{className:"text-sm text-amber-700 mt-1",children:["Your account is scheduled for deletion on"," ",(0,r.jsx)("strong",{children:E(e.scheduledFor)}),".",!e.confirmedAt&&" Please confirm to proceed."]})]})]})}),(0,r.jsxs)("div",{className:"flex gap-3",children:[!e.confirmedAt&&(0,r.jsx)(i.$,{variant:"destructive",onClick:C,disabled:"confirm"===o,children:"confirm"===o?"Confirming...":"Confirm Deletion"}),(0,r.jsx)(i.$,{variant:"outline",onClick:S,disabled:"cancel"===o,children:"cancel"===o?"Cancelling...":"Cancel Request"})]})]}):v?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-medium text-red-800",children:"Are you sure?"}),(0,r.jsx)("p",{className:"text-sm text-red-700 mt-1",children:"This will permanently delete your account and all your data. This action cannot be undone. You will have a 30-day grace period to cancel."})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(i.$,{variant:"destructive",onClick:k,disabled:"delete"===o,children:"delete"===o?"Processing...":"Yes, Delete My Account"}),(0,r.jsx)(i.$,{variant:"outline",onClick:()=>N(!1),children:"Cancel"})]})]}):(0,r.jsxs)(i.$,{variant:"destructive",onClick:()=>N(!0),className:"gap-2",children:[(0,r.jsx)(j.A,{className:"h-4 w-4","aria-hidden":"true"}),"Delete My Account"]})})]}),g&&(0,r.jsx)("div",{className:"p-3 rounded-md text-sm ".concat("success"===g.type?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"),role:"alert",children:g.text})]})}function y(){let[e,t]=(0,s.useState)(null),[a,x]=(0,s.useState)(""),[u,m]=(0,s.useState)(!0),[f,h]=(0,s.useState)(!1),[p,j]=(0,s.useState)(null),b=(0,n.U)();(0,s.useEffect)(()=>{!async function(){let{data:{user:e}}=await b.auth.getUser();if(e){var a,r;t({email:e.email||"",name:(null==(a=e.user_metadata)?void 0:a.name)||null}),x((null==(r=e.user_metadata)?void 0:r.name)||"")}m(!1)}()},[b.auth]);let y=async()=>{h(!0),j(null);try{let{error:e}=await b.auth.updateUser({data:{name:a}});if(e)throw e;t(e=>e?{...e,name:a}:null),j({type:"success",text:"Profile updated successfully"})}catch(e){j({type:"error",text:e instanceof Error?e.message:"Failed to update profile"})}finally{h(!1)}};return u?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,r.jsxs)("div",{className:"space-y-6 max-w-2xl",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"User Settings"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Manage your account settings and profile"})]}),(0,r.jsxs)(l.Zp,{children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsx)(l.ZB,{children:"Profile"}),(0,r.jsx)(l.BT,{children:"Your personal account information"})]}),(0,r.jsxs)(l.Wu,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(o.H,{email:(null==e?void 0:e.email)||"",name:(null==e?void 0:e.name)||void 0,size:"lg"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:(null==e?void 0:e.name)||"No name set"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:null==e?void 0:e.email})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(d.J,{htmlFor:"name",children:"Display Name"}),(0,r.jsx)(c.p,{id:"name",value:a,onChange:e=>x(e.target.value),placeholder:"Enter your name"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(d.J,{htmlFor:"email",children:"Email"}),(0,r.jsx)(c.p,{id:"email",value:(null==e?void 0:e.email)||"",disabled:!0,className:"bg-gray-50"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Email cannot be changed"})]}),p&&(0,r.jsx)("div",{className:"p-3 rounded-md text-sm ".concat("success"===p.type?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"),children:p.text}),(0,r.jsx)(i.$,{onClick:y,disabled:f,children:f?"Saving...":"Save Changes"})]})]}),(0,r.jsx)(g,{})]})}},5142:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var r=a(5155);a(2115);var s=a(4269);function n(e){let{className:t,type:a,...n}=e;return(0,r.jsx)("input",{type:a,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}},5781:(e,t,a)=>{Promise.resolve().then(a.bind(a,2658))},6444:(e,t,a)=>{"use strict";a.d(t,{J:()=>l});var r=a(5155);a(2115);var s=a(2894),n=a(4269);function l(e){let{className:t,...a}=e;return(0,r.jsx)(s.b,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}},6648:(e,t,a)=>{"use strict";a.d(t,{U:()=>s});var r=a(5890);function s(){return(0,r.createBrowserClient)("https://tkzoygqdcvkrwmhzpttl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrem95Z3FkY3ZrcndtaHpwdHRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyNjk1OTgsImV4cCI6MjA4Mzg0NTU5OH0.vfqxbZm5PRKsdXb6QnQukmQ1_PEb_feUDJFtV5_F5vg")}},6948:(e,t,a)=>{"use strict";a.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>i,Zp:()=>n,aR:()=>l,wL:()=>o});var r=a(5155);a(2115);var s=a(4269);function n(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function l(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function i(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...a})}function c(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...a})}function o(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-footer",className:(0,s.cn)("flex items-center px-6 [.border-t]:pt-6",t),...a})}},8927:(e,t,a)=>{"use strict";a.d(t,{H:()=>c});var r=a(5155),s=a(2115),n=a(4269);let l={sm:"h-8 w-8 text-xs",md:"h-9 w-9 text-sm",lg:"h-12 w-12 text-base"},i={sm:32,md:36,lg:48};function c(e){let{email:t,name:a,size:c="md",className:d}=e,[o,x]=(0,s.useState)(!1),u=function(e,t){if(e){let t=e.trim().split(/\s+/);return 1===t.length?t[0].charAt(0).toUpperCase():(t[0].charAt(0)+t[t.length-1].charAt(0)).toUpperCase()}return t.slice(0,2).toUpperCase()}(a,t),m=function(e,t){let a=function(e){function t(e,t){return e<<t|e>>>32-t}function a(e,t){let a=0x80000000&e,r=0x80000000&t,s=0x40000000&e,n=0x40000000&t,l=(0x3fffffff&e)+(0x3fffffff&t);return s&n?0x80000000^l^a^r:s|n?0x40000000&l?0xc0000000^l^a^r:0x40000000^l^a^r:l^a^r}function r(e,r,s,n,l,i,c){return e=a(e,a(a(r&s|~r&n,l),c)),a(t(e,i),r)}function s(e,r,s,n,l,i,c){return e=a(e,a(a(r&n|s&~n,l),c)),a(t(e,i),r)}function n(e,r,s,n,l,i,c){return e=a(e,a(a(r^s^n,l),c)),a(t(e,i),r)}function l(e,r,s,n,l,i,c){return e=a(e,a(a(s^(r|~n),l),c)),a(t(e,i),r)}function i(e){let t="";for(let a=0;a<=3;a++)t+=("0"+(e>>>8*a&255).toString(16)).slice(-2);return t}let c=function(e){let t=e.length,a=t+8,r=((a-a%64)/64+1)*16,s=Array(r-1).fill(0),n=0,l=0;for(;l<t;){let t=(l-l%4)/4;n=l%4*8,s[t]=s[t]|e.charCodeAt(l)<<n,l++}let i=(l-l%4)/4;return n=l%4*8,s[i]=s[i]|128<<n,s[r-2]=t<<3,s[r-1]=t>>>29,s}(e),d=0x67452301,o=0xefcdab89,x=0x98badcfe,u=0x10325476;for(let e=0;e<c.length;e+=16){let t=d,i=o,m=x,f=u;d=r(d,o,x,u,c[e+0],7,0xd76aa478),u=r(u,d,o,x,c[e+1],12,0xe8c7b756),x=r(x,u,d,o,c[e+2],17,0x242070db),o=r(o,x,u,d,c[e+3],22,0xc1bdceee),d=r(d,o,x,u,c[e+4],7,0xf57c0faf),u=r(u,d,o,x,c[e+5],12,0x4787c62a),x=r(x,u,d,o,c[e+6],17,0xa8304613),o=r(o,x,u,d,c[e+7],22,0xfd469501),d=r(d,o,x,u,c[e+8],7,0x698098d8),u=r(u,d,o,x,c[e+9],12,0x8b44f7af),x=r(x,u,d,o,c[e+10],17,0xffff5bb1),o=r(o,x,u,d,c[e+11],22,0x895cd7be),d=r(d,o,x,u,c[e+12],7,0x6b901122),u=r(u,d,o,x,c[e+13],12,0xfd987193),x=r(x,u,d,o,c[e+14],17,0xa679438e),o=r(o,x,u,d,c[e+15],22,0x49b40821),d=s(d,o,x,u,c[e+1],5,0xf61e2562),u=s(u,d,o,x,c[e+6],9,0xc040b340),x=s(x,u,d,o,c[e+11],14,0x265e5a51),o=s(o,x,u,d,c[e+0],20,0xe9b6c7aa),d=s(d,o,x,u,c[e+5],5,0xd62f105d),u=s(u,d,o,x,c[e+10],9,0x2441453),x=s(x,u,d,o,c[e+15],14,0xd8a1e681),o=s(o,x,u,d,c[e+4],20,0xe7d3fbc8),d=s(d,o,x,u,c[e+9],5,0x21e1cde6),u=s(u,d,o,x,c[e+14],9,0xc33707d6),x=s(x,u,d,o,c[e+3],14,0xf4d50d87),o=s(o,x,u,d,c[e+8],20,0x455a14ed),d=s(d,o,x,u,c[e+13],5,0xa9e3e905),u=s(u,d,o,x,c[e+2],9,0xfcefa3f8),x=s(x,u,d,o,c[e+7],14,0x676f02d9),o=s(o,x,u,d,c[e+12],20,0x8d2a4c8a),d=n(d,o,x,u,c[e+5],4,0xfffa3942),u=n(u,d,o,x,c[e+8],11,0x8771f681),x=n(x,u,d,o,c[e+11],16,0x6d9d6122),o=n(o,x,u,d,c[e+14],23,0xfde5380c),d=n(d,o,x,u,c[e+1],4,0xa4beea44),u=n(u,d,o,x,c[e+4],11,0x4bdecfa9),x=n(x,u,d,o,c[e+7],16,0xf6bb4b60),o=n(o,x,u,d,c[e+10],23,0xbebfbc70),d=n(d,o,x,u,c[e+13],4,0x289b7ec6),u=n(u,d,o,x,c[e+0],11,0xeaa127fa),x=n(x,u,d,o,c[e+3],16,0xd4ef3085),o=n(o,x,u,d,c[e+6],23,0x4881d05),d=n(d,o,x,u,c[e+9],4,0xd9d4d039),u=n(u,d,o,x,c[e+12],11,0xe6db99e5),x=n(x,u,d,o,c[e+15],16,0x1fa27cf8),o=n(o,x,u,d,c[e+2],23,0xc4ac5665),d=l(d,o,x,u,c[e+0],6,0xf4292244),u=l(u,d,o,x,c[e+7],10,0x432aff97),x=l(x,u,d,o,c[e+14],15,0xab9423a7),o=l(o,x,u,d,c[e+5],21,0xfc93a039),d=l(d,o,x,u,c[e+12],6,0x655b59c3),u=l(u,d,o,x,c[e+3],10,0x8f0ccc92),x=l(x,u,d,o,c[e+10],15,0xffeff47d),o=l(o,x,u,d,c[e+1],21,0x85845dd1),d=l(d,o,x,u,c[e+8],6,0x6fa87e4f),u=l(u,d,o,x,c[e+15],10,0xfe2ce6e0),x=l(x,u,d,o,c[e+6],15,0xa3014314),o=l(o,x,u,d,c[e+13],21,0x4e0811a1),d=l(d,o,x,u,c[e+4],6,0xf7537e82),u=l(u,d,o,x,c[e+11],10,0xbd3af235),x=l(x,u,d,o,c[e+2],15,0x2ad7d2bb),o=l(o,x,u,d,c[e+9],21,0xeb86d391),d=a(d,t),o=a(o,i),x=a(x,m),u=a(u,f)}return(i(d)+i(o)+i(x)+i(u)).toLowerCase()}(e.trim().toLowerCase());return"https://www.gravatar.com/avatar/".concat(a,"?s=").concat(t,"&d=404")}(t,2*i[c]);return o?(0,r.jsx)("div",{className:(0,n.cn)("rounded-full bg-[#3D3D3D] text-white flex items-center justify-center font-medium",l[c],d),children:u}):(0,r.jsx)("img",{src:m,alt:a||t,className:(0,n.cn)("rounded-full object-cover",l[c],d),onError:()=>x(!0)})}}},e=>{e.O(0,[4909,2619,5890,7917,3479,8441,1255,7358],()=>e(e.s=5781)),_N_E=e.O()}]);