generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Organization {
  id                   String               @id @default(cuid())
  name                 String
  createdAt            DateTime             @default(now()) @map("created_at")
  updatedAt            DateTime             @updatedAt @map("updated_at")
  billingCycle         BillingCycle?        @map("billing_cycle")
  planTier             PlanTier             @default(FOUNDATION) @map("plan_tier")
  stripeCustomerId     String?              @unique @map("stripe_customer_id")
  stripeSubscriptionId String?              @unique @map("stripe_subscription_id")
  subscriptionStatus   SubscriptionStatus   @default(ACTIVE) @map("subscription_status")
  trialEndsAt          DateTime?            @map("trial_ends_at")
  trialStartedAt       DateTime?            @map("trial_started_at")
  companies            Company[]
  invites              OrganizationInvite[]
  users                OrganizationUser[]
  personalFinancials   PersonalFinancials?

  @@map("organizations")
}

model User {
  id                       String                    @id @default(cuid())
  authId                   String                    @unique @map("auth_id")
  email                    String                    @unique
  name                     String?
  avatarUrl                String?                   @map("avatar_url")
  isSuperAdmin             Boolean                   @default(false) @map("is_super_admin")
  userType                 UserType                  @default(SUBSCRIBER) @map("user_type")
  createdAt                DateTime                  @default(now()) @map("created_at")
  updatedAt                DateTime                  @updatedAt @map("updated_at")
  advisorProfile           AdvisorProfile?
  auditLogs                AuditLog[]                @relation("AuditActor")
  deletionRequests         DataDeletionRequest[]
  dataExports              DataExportRequest[]
  documentVersionsUploaded DataRoomDocumentVersion[]
  documentsUploaded        DataRoomDocument[]        @relation("DocumentUploader")
  dataRoomNotifications    DataRoomNotification[]    @relation("NotificationRecipient")
  impersonationsAsAdmin    ImpersonationSession[]    @relation("ImpersonationAdmin")
  impersonationsAsTarget   ImpersonationSession[]    @relation("ImpersonationTarget")
  sentInvites              OrganizationInvite[]
  organizations            OrganizationUser[]
  ticketsAssigned          SupportTicket[]           @relation("TicketAssignee")
  ticketsCreated           SupportTicket[]           @relation("TicketUser")
  taskAssignments          TaskAssignment[]
  taskInvitesSent          TaskInvite[]              @relation("TaskInvitesSent")
  primaryTasks             Task[]                    @relation("TaskPrimaryAssignee")
  ticketMessages           TicketMessage[]
  twoFactorAuth            TwoFactorAuth?
  consents                 UserConsent[]
  sessions                 UserSession[]
  createdSnapshots         ValuationSnapshot[]
  // Company ownership & access relations
  companyOwnerships        CompanyOwnership[]
  companyStaffAccess       CompanyStaffAccess[]
  accessRequestsSubmitted  AccessRequest[]           @relation("AccessRequester")
  accessRequestsReceived   AccessRequest[]           @relation("AccessOwner")
  alerts                   Alert[]
  companyInvitesSent       CompanyInvite[]           @relation("CompanyInviter")

  @@map("users")
}

model TwoFactorAuth {
  id              String    @id @default(cuid())
  userId          String    @unique @map("user_id")
  encryptedSecret String    @map("encrypted_secret")
  backupCodes     String[]  @map("backup_codes")
  usedBackupCodes Int[]     @default([]) @map("used_backup_codes")
  enabled         Boolean   @default(false)
  verifiedAt      DateTime? @map("verified_at")
  lastUsedAt      DateTime? @map("last_used_at")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")
  user            User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("two_factor_auth")
}

model UserSession {
  id           String    @id @default(cuid())
  userId       String    @map("user_id")
  sessionToken String    @unique @map("session_token")
  userAgent    String?   @map("user_agent")
  ipAddress    String?   @map("ip_address")
  location     String?
  deviceType   String?   @map("device_type")
  browser      String?
  os           String?
  lastActiveAt DateTime  @default(now()) @map("last_active_at")
  createdAt    DateTime  @default(now()) @map("created_at")
  expiresAt    DateTime  @map("expires_at")
  revokedAt    DateTime? @map("revoked_at")
  user         User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, revokedAt])
  @@index([sessionToken])
  @@map("user_sessions")
}

model OrganizationUser {
  id                   String               @id @default(cuid())
  organizationId       String               @map("organization_id")
  userId               String               @map("user_id")
  role                 UserRole             @default(MEMBER)
  functionalCategories FunctionalCategory[] @map("functional_categories")
  joinedAt             DateTime             @default(now()) @map("joined_at")
  isExternalAdvisor    Boolean              @default(false) @map("is_external_advisor")
  roleTemplateId       String?              @map("role_template_id")
  customPermissions    MemberPermission[]
  organization         Organization         @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  roleTemplate         RoleTemplate?        @relation(fields: [roleTemplateId], references: [id])
  user                 User                 @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([organizationId, userId])
  @@map("organization_users")
}

model OrganizationInvite {
  id                   String               @id @default(cuid())
  organizationId       String               @map("organization_id")
  email                String
  role                 UserRole             @default(MEMBER)
  functionalCategories FunctionalCategory[] @map("functional_categories")
  invitedBy            String               @map("invited_by")
  token                String               @unique @default(cuid())
  expiresAt            DateTime             @map("expires_at")
  acceptedAt           DateTime?            @map("accepted_at")
  createdAt            DateTime             @default(now()) @map("created_at")
  customPermissions    Json?                @map("custom_permissions")
  isExternalAdvisor    Boolean              @default(false) @map("is_external_advisor")
  roleTemplateId       String?              @map("role_template_id")
  inviter              User                 @relation(fields: [invitedBy], references: [id])
  organization         Organization         @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  roleTemplate         RoleTemplate?        @relation(fields: [roleTemplateId], references: [id])

  @@unique([organizationId, email])
  @@map("organization_invites")
}

model Company {
  id                 String                    @id @default(cuid())
  organizationId     String                    @map("organization_id")
  name               String
  icbIndustry        String                    @map("icb_industry")
  icbSuperSector     String                    @map("icb_super_sector")
  icbSector          String                    @map("icb_sector")
  icbSubSector       String                    @map("icb_sub_sector")
  annualRevenue      Decimal                   @map("annual_revenue") @db.Decimal(15, 2)
  annualEbitda       Decimal                   @map("annual_ebitda") @db.Decimal(15, 2)
  ownerCompensation  Decimal                   @default(0) @map("owner_compensation") @db.Decimal(15, 2)
  briWeights         Json?                     @map("bri_weights")
  createdAt          DateTime                  @default(now()) @map("created_at")
  updatedAt          DateTime                  @updatedAt @map("updated_at")
  deletedAt          DateTime?                 @map("deleted_at")
  deleteReason       String?                   @map("delete_reason")
  fiscalYearEndDay   Int                       @default(31) @map("fiscal_year_end_day")
  fiscalYearEndMonth Int                       @default(12) @map("fiscal_year_end_month")
  assessments        Assessment[]
  buyerProspects     BuyerProspect[]
  organization       Organization              @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  questionPriorities CompanyQuestionPriority[]
  coreFactors        CoreFactors?
  dataRoomDocuments  DataRoomDocument[]
  dataRoomTags       DataRoomTag[]
  dataRoom           DataRoom?
  dcfAssumptions     DCFAssumptions?
  ebitdaAdjustments  EbitdaAdjustment[]
  financialPeriods   FinancialPeriod[]
  integrations       Integration[]
  projectAssessments ProjectAssessment[]
  prospectImports    ProspectImportBatch[]
  prospectiveBuyers  ProspectiveBuyer[]
  sprints            Sprint[]
  tasks              Task[]
  valuationSnapshots ValuationSnapshot[]
  // Company ownership & access relations
  ownerships         CompanyOwnership[]
  staffAccess        CompanyStaffAccess[]
  accessRequests     AccessRequest[]
  companyInvites     CompanyInvite[]

  @@map("companies")
}

model RoleTemplate {
  id                 String               @id @default(cuid())
  slug               String               @unique
  name               String
  description        String?
  icon               String?
  defaultPermissions Json
  isBuiltIn          Boolean              @default(true) @map("is_built_in")
  createdAt          DateTime             @default(now()) @map("created_at")
  updatedAt          DateTime             @updatedAt @map("updated_at")
  invites            OrganizationInvite[]
  members            OrganizationUser[]

  @@map("role_templates")
}

model MemberPermission {
  id                 String           @id @default(cuid())
  organizationUserId String           @map("organization_user_id")
  permission         String
  granted            Boolean
  organizationUser   OrganizationUser @relation(fields: [organizationUserId], references: [id], onDelete: Cascade)

  @@unique([organizationUserId, permission])
  @@map("member_permissions")
}

model AdvisorProfile {
  id        String   @id @default(cuid())
  userId    String   @unique @map("user_id")
  firmName  String?  @map("firm_name")
  specialty String?
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("advisor_profiles")
}

model PersonalFinancials {
  id                  String       @id @default(cuid())
  retirementAccounts  Json?        @map("retirement_accounts")
  totalRetirement     Decimal?     @map("total_retirement") @db.Decimal(15, 2)
  personalAssets      Json?        @map("personal_assets")
  personalLiabilities Json?        @map("personal_liabilities")
  netWorth            Decimal?     @map("net_worth") @db.Decimal(15, 2)
  exitGoalAmount      Decimal?     @map("exit_goal_amount") @db.Decimal(15, 2)
  retirementAge       Int?         @map("retirement_age")
  notes               String?
  createdAt           DateTime     @default(now()) @map("created_at")
  updatedAt           DateTime     @updatedAt @map("updated_at")
  organizationId      String       @unique @map("organization_id")
  organization        Organization @relation(fields: [organizationId], references: [id])

  @@map("personal_financials")
}

model EbitdaAdjustment {
  id          String           @id @default(cuid())
  companyId   String           @map("company_id")
  periodId    String?          @map("period_id")
  description String
  amount      Decimal          @db.Decimal(15, 2)
  type        String
  frequency   String           @default("ANNUAL")
  createdAt   DateTime         @default(now()) @map("created_at")
  company     Company          @relation(fields: [companyId], references: [id], onDelete: Cascade)
  period      FinancialPeriod? @relation(fields: [periodId], references: [id])

  @@index([companyId, periodId])
  @@map("ebitda_adjustments")
}

model CoreFactors {
  id                  String                @id @default(cuid())
  companyId           String                @unique @map("company_id")
  revenueSizeCategory RevenueSizeCategory   @map("revenue_size_category")
  revenueModel        RevenueModelType      @map("revenue_model")
  grossMarginProxy    GrossMarginCategory   @map("gross_margin_proxy")
  laborIntensity      LaborIntensityLevel   @map("labor_intensity")
  assetIntensity      AssetIntensityLevel   @map("asset_intensity")
  ownerInvolvement    OwnerInvolvementLevel @map("owner_involvement")
  updatedAt           DateTime              @updatedAt @map("updated_at")
  company             Company               @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("core_factors")
}

model Question {
  id              String               @id @default(cuid())
  briCategory     BriCategory          @map("bri_category")
  issueTier       IssueTier            @default(OPTIMIZATION) @map("issue_tier")
  questionText    String               @map("question_text")
  helpText        String?              @map("help_text")
  buyerLogic      String?              @map("buyer_logic") @db.VarChar(200)
  displayOrder    Int                  @map("display_order")
  maxImpactPoints Decimal              @map("max_impact_points") @db.Decimal(5, 2)
  isActive        Boolean              @default(true) @map("is_active")
  responses       AssessmentResponse[]
  options         QuestionOption[]

  @@index([issueTier])
  @@map("questions")
}

model QuestionOption {
  id                 String               @id @default(cuid())
  questionId         String               @map("question_id")
  optionText         String               @map("option_text")
  scoreValue         Decimal              @map("score_value") @db.Decimal(3, 2)
  displayOrder       Int                  @map("display_order")
  effectiveResponses AssessmentResponse[] @relation("EffectiveOption")
  responses          AssessmentResponse[] @relation("SelectedOption")
  question           Question             @relation(fields: [questionId], references: [id], onDelete: Cascade)
  tasksUpgradingFrom Task[]               @relation("TaskUpgradeFrom")
  tasksUpgradingTo   Task[]               @relation("TaskUpgradeTo")

  @@map("question_options")
}

model Assessment {
  id             String               @id @default(cuid())
  companyId      String               @map("company_id")
  assessmentType AssessmentType       @map("assessment_type")
  completedAt    DateTime?            @map("completed_at")
  createdAt      DateTime             @default(now()) @map("created_at")
  updatedAt      DateTime             @updatedAt @map("updated_at")
  responses      AssessmentResponse[]
  company        Company              @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("assessments")
}

model AssessmentResponse {
  id                String          @id @default(cuid())
  assessmentId      String          @map("assessment_id")
  questionId        String          @map("question_id")
  selectedOptionId  String          @map("selected_option_id")
  effectiveOptionId String?         @map("effective_option_id")
  confidenceLevel   ConfidenceLevel @map("confidence_level")
  notes             String?
  evidenceUploaded  Boolean         @default(false) @map("evidence_uploaded")
  evidenceUrls      String[]        @map("evidence_urls")
  createdAt         DateTime        @default(now()) @map("created_at")
  updatedAt         DateTime        @updatedAt @map("updated_at")
  assessment        Assessment      @relation(fields: [assessmentId], references: [id], onDelete: Cascade)
  effectiveOption   QuestionOption? @relation("EffectiveOption", fields: [effectiveOptionId], references: [id])
  question          Question        @relation(fields: [questionId], references: [id])
  selectedOption    QuestionOption  @relation("SelectedOption", fields: [selectedOptionId], references: [id])

  @@unique([assessmentId, questionId])
  @@map("assessment_responses")
}

model ValuationSnapshot {
  id                   String   @id @default(cuid())
  companyId            String   @map("company_id")
  createdByUserId      String?  @map("created_by_user_id")
  adjustedEbitda       Decimal  @map("adjusted_ebitda") @db.Decimal(15, 2)
  industryMultipleLow  Decimal  @map("industry_multiple_low") @db.Decimal(4, 2)
  industryMultipleHigh Decimal  @map("industry_multiple_high") @db.Decimal(4, 2)
  coreScore            Decimal  @map("core_score") @db.Decimal(5, 4)
  briScore             Decimal  @map("bri_score") @db.Decimal(5, 4)
  briFinancial         Decimal  @map("bri_financial") @db.Decimal(5, 4)
  briTransferability   Decimal  @map("bri_transferability") @db.Decimal(5, 4)
  briOperational       Decimal  @map("bri_operational") @db.Decimal(5, 4)
  briMarket            Decimal  @map("bri_market") @db.Decimal(5, 4)
  briLegalTax          Decimal  @map("bri_legal_tax") @db.Decimal(5, 4)
  briPersonal          Decimal  @map("bri_personal") @db.Decimal(5, 4)
  baseMultiple         Decimal  @map("base_multiple") @db.Decimal(4, 2)
  discountFraction     Decimal  @map("discount_fraction") @db.Decimal(5, 4)
  finalMultiple        Decimal  @map("final_multiple") @db.Decimal(4, 2)
  currentValue         Decimal  @map("current_value") @db.Decimal(15, 2)
  potentialValue       Decimal  @map("potential_value") @db.Decimal(15, 2)
  valueGap             Decimal  @map("value_gap") @db.Decimal(15, 2)
  alphaConstant        Decimal  @default(0.40) @map("alpha_constant") @db.Decimal(3, 2)
  snapshotReason       String?  @map("snapshot_reason")
  createdAt            DateTime @default(now()) @map("created_at")
  company              Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  createdBy            User?    @relation(fields: [createdByUserId], references: [id])

  @@index([companyId, createdAt])
  @@map("valuation_snapshots")
}

model Task {
  id                   String             @id @default(cuid())
  companyId            String             @map("company_id")
  title                String
  description          String
  richDescription      Json?              @map("rich_description")
  actionType           ActionItemType     @map("action_type")
  briCategory          BriCategory        @map("bri_category")
  linkedQuestionId     String?            @map("linked_question_id")
  rawImpact            Decimal            @map("raw_impact") @db.Decimal(15, 2)
  normalizedValue      Decimal            @map("normalized_value") @db.Decimal(15, 2)
  effortLevel          EffortLevel        @map("effort_level")
  complexity           ComplexityLevel
  estimatedHours       Int?               @map("estimated_hours")
  issueTier            IssueTier?         @map("issue_tier")
  status               TaskStatus         @default(PENDING)
  deferredUntil        DateTime?          @map("deferred_until")
  deferralReason       String?            @map("deferral_reason")
  blockedAt            DateTime?          @map("blocked_at")
  blockedReason        String?            @map("blocked_reason")
  completedAt          DateTime?          @map("completed_at")
  completionNotes      String?            @map("completion_notes")
  sprintId             String?            @map("sprint_id")
  sprintPriority       SprintPriority?    @map("sprint_priority")
  dueDate              DateTime?          @map("due_date")
  primaryAssigneeId    String?            @map("primary_assignee_id")
  upgradesFromOptionId String?            @map("upgrades_from_option_id")
  upgradesToOptionId   String?            @map("upgrades_to_option_id")
  createdAt            DateTime           @default(now()) @map("created_at")
  updatedAt            DateTime           @updatedAt @map("updated_at")
  difficultyLevel      DifficultyLevel    @default(MEDIUM) @map("difficulty_level")
  impactLevel          ImpactLevel        @default(MEDIUM) @map("impact_level")
  inActionPlan         Boolean            @default(false) @map("in_action_plan")
  priorityRank         Int                @default(10) @map("priority_rank")
  proofDocuments       DataRoomDocument[] @relation("TaskProofDocuments")
  assignments          TaskAssignment[]
  invites              TaskInvite[]
  company              Company            @relation(fields: [companyId], references: [id], onDelete: Cascade)
  primaryAssignee      User?              @relation("TaskPrimaryAssignee", fields: [primaryAssigneeId], references: [id])
  sprint               Sprint?            @relation(fields: [sprintId], references: [id])
  upgradesFromOption   QuestionOption?    @relation("TaskUpgradeFrom", fields: [upgradesFromOptionId], references: [id])
  upgradesToOption     QuestionOption?    @relation("TaskUpgradeTo", fields: [upgradesToOptionId], references: [id])

  @@index([companyId, status])
  @@index([sprintId])
  @@index([primaryAssigneeId])
  @@index([primaryAssigneeId, status])
  @@map("tasks")
}

model TaskAssignment {
  id         String   @id @default(cuid())
  taskId     String   @map("task_id")
  userId     String   @map("user_id")
  assignedAt DateTime @default(now()) @map("assigned_at")
  task       Task     @relation(fields: [taskId], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([taskId, userId])
  @@map("task_assignments")
}

model TaskInvite {
  id          String    @id @default(cuid())
  taskId      String    @map("task_id")
  email       String
  invitedById String    @map("invited_by_id")
  token       String    @unique @default(cuid())
  isPrimary   Boolean   @default(true) @map("is_primary")
  expiresAt   DateTime  @map("expires_at")
  acceptedAt  DateTime? @map("accepted_at")
  declinedAt  DateTime? @map("declined_at")
  createdAt   DateTime  @default(now()) @map("created_at")
  invitedBy   User      @relation("TaskInvitesSent", fields: [invitedById], references: [id])
  task        Task      @relation(fields: [taskId], references: [id], onDelete: Cascade)

  @@unique([taskId, email])
  @@index([token])
  @@index([email])
  @@map("task_invites")
}

model Sprint {
  id                  String       @id @default(cuid())
  companyId           String       @map("company_id")
  name                String
  startDate           DateTime     @map("start_date")
  endDate             DateTime     @map("end_date")
  targetValueIncrease Decimal      @map("target_value_increase") @db.Decimal(15, 2)
  actualValueIncrease Decimal?     @map("actual_value_increase") @db.Decimal(15, 2)
  status              SprintStatus @default(PLANNING)
  createdAt           DateTime     @default(now()) @map("created_at")
  updatedAt           DateTime     @updatedAt @map("updated_at")
  company             Company      @relation(fields: [companyId], references: [id], onDelete: Cascade)
  tasks               Task[]

  @@index([companyId, status])
  @@map("sprints")
}

model IndustryMultiple {
  id                  String   @id @default(cuid())
  icbIndustry         String   @map("icb_industry")
  icbSuperSector      String   @map("icb_super_sector")
  icbSector           String   @map("icb_sector")
  icbSubSector        String   @map("icb_sub_sector")
  revenueMultipleLow  Decimal  @map("revenue_multiple_low") @db.Decimal(4, 2)
  revenueMultipleHigh Decimal  @map("revenue_multiple_high") @db.Decimal(4, 2)
  ebitdaMultipleLow   Decimal  @map("ebitda_multiple_low") @db.Decimal(4, 2)
  ebitdaMultipleHigh  Decimal  @map("ebitda_multiple_high") @db.Decimal(4, 2)
  effectiveDate       DateTime @map("effective_date")
  source              String?

  @@unique([icbSubSector, effectiveDate])
  @@map("industry_multiples")
}

model DataRoom {
  id            String                 @id @default(cuid())
  companyId     String                 @unique @map("company_id")
  name          String                 @default("Data Room")
  stage         DataRoomStage          @default(PREPARATION)
  createdAt     DateTime               @default(now()) @map("created_at")
  updatedAt     DateTime               @updatedAt @map("updated_at")
  accessGrants  DataRoomAccess[]
  activities    DataRoomActivity[]
  folders       DataRoomFolder[]
  notifications DataRoomNotification[]
  questions     DataRoomQuestion[]
  company       Company                @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("data_rooms")
}

model DataRoomFolder {
  id          String             @id @default(cuid())
  dataRoomId  String             @map("data_room_id")
  parentId    String?            @map("parent_id")
  name        String
  description String?
  category    DataRoomCategory
  sortOrder   Int                @default(0) @map("sort_order")
  minStage    DataRoomStage      @default(PREPARATION) @map("min_stage")
  createdAt   DateTime           @default(now()) @map("created_at")
  updatedAt   DateTime           @updatedAt @map("updated_at")
  documents   DataRoomDocument[]
  dataRoom    DataRoom           @relation(fields: [dataRoomId], references: [id], onDelete: Cascade)
  parent      DataRoomFolder?    @relation("FolderHierarchy", fields: [parentId], references: [id], onDelete: Cascade)
  children    DataRoomFolder[]   @relation("FolderHierarchy")

  @@index([dataRoomId, parentId])
  @@index([dataRoomId, category])
  @@map("data_room_folders")
}

model DataRoomDocument {
  id                String                    @id @default(cuid())
  companyId         String                    @map("company_id")
  category          DataRoomCategory
  documentName      String                    @map("document_name")
  description       String?
  linkedTaskId      String?                   @map("linked_task_id")
  fileUrl           String?                   @map("file_url")
  filePath          String?                   @map("file_path")
  fileName          String?                   @map("file_name")
  fileSize          Int?                      @map("file_size")
  mimeType          String?                   @map("mime_type")
  updateFrequency   UpdateFrequency           @default(AS_NEEDED) @map("update_frequency")
  lastUpdatedAt     DateTime?                 @map("last_updated_at")
  nextUpdateDue     DateTime?                 @map("next_update_due")
  status            DocumentStatus            @default(CURRENT)
  isRequired        Boolean                   @default(false) @map("is_required")
  isCustom          Boolean                   @default(false) @map("is_custom")
  displayOrder      Int                       @default(0) @map("display_order")
  uploadedByUserId  String?                   @map("uploaded_by_user_id")
  notes             String?
  createdAt         DateTime                  @default(now()) @map("created_at")
  updatedAt         DateTime                  @updatedAt @map("updated_at")
  allowDownload     Boolean                   @default(true) @map("allow_download")
  folderId          String?                   @map("folder_id")
  isConfidential    Boolean                   @default(false) @map("is_confidential")
  previousVersionId String?                   @map("previous_version_id")
  version           Int                       @default(1)
  tags              DataRoomDocumentTag[]
  versions          DataRoomDocumentVersion[]
  views             DataRoomDocumentView[]
  company           Company                   @relation(fields: [companyId], references: [id], onDelete: Cascade)
  folder            DataRoomFolder?           @relation(fields: [folderId], references: [id])
  linkedTask        Task?                     @relation("TaskProofDocuments", fields: [linkedTaskId], references: [id])
  previousVersion   DataRoomDocument?         @relation("DocumentVersions", fields: [previousVersionId], references: [id])
  newerVersions     DataRoomDocument[]        @relation("DocumentVersions")
  uploadedBy        User?                     @relation("DocumentUploader", fields: [uploadedByUserId], references: [id])

  @@index([companyId, category])
  @@index([companyId, status])
  @@index([folderId])
  @@index([linkedTaskId])
  @@map("data_room_documents")
}

model DataRoomDocumentVersion {
  id               String           @id @default(cuid())
  documentId       String           @map("document_id")
  version          Int
  filePath         String           @map("file_path")
  fileName         String           @map("file_name")
  fileSize         Int              @map("file_size")
  mimeType         String?          @map("mime_type")
  uploadedByUserId String?          @map("uploaded_by_user_id")
  uploadedAt       DateTime         @map("uploaded_at")
  archivedAt       DateTime         @default(now()) @map("archived_at")
  document         DataRoomDocument @relation(fields: [documentId], references: [id], onDelete: Cascade)
  uploadedBy       User?            @relation(fields: [uploadedByUserId], references: [id])

  @@index([documentId])
  @@map("data_room_document_versions")
}

model DataRoomTag {
  id        String                @id @default(cuid())
  companyId String                @map("company_id")
  name      String
  color     String                @default("#6B7280")
  createdAt DateTime              @default(now()) @map("created_at")
  documents DataRoomDocumentTag[]
  company   Company               @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, name])
  @@map("data_room_tags")
}

model DataRoomDocumentTag {
  id         String           @id @default(cuid())
  documentId String           @map("document_id")
  tagId      String           @map("tag_id")
  createdAt  DateTime         @default(now()) @map("created_at")
  document   DataRoomDocument @relation(fields: [documentId], references: [id], onDelete: Cascade)
  tag        DataRoomTag      @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@unique([documentId, tagId])
  @@map("data_room_document_tags")
}

model DataRoomAccess {
  id           String              @id @default(cuid())
  dataRoomId   String              @map("data_room_id")
  userId       String?             @map("user_id")
  email        String
  accessLevel  DataRoomAccessLevel @default(VIEWER) @map("access_level")
  maxStage     DataRoomStage       @default(POST_NDA) @map("max_stage")
  folderIds    String[]            @map("folder_ids")
  expiresAt    DateTime?           @map("expires_at")
  ndaSignedAt  DateTime?           @map("nda_signed_at")
  invitedById  String              @map("invited_by_id")
  createdAt    DateTime            @default(now()) @map("created_at")
  updatedAt    DateTime            @updatedAt @map("updated_at")
  buyerContact BuyerContact?
  dataRoom     DataRoom            @relation(fields: [dataRoomId], references: [id], onDelete: Cascade)

  @@unique([dataRoomId, email])
  @@index([dataRoomId, userId])
  @@map("data_room_access")
}

model DataRoomActivity {
  id         String         @id @default(cuid())
  dataRoomId String         @map("data_room_id")
  userId     String         @map("user_id")
  userEmail  String         @map("user_email")
  action     DataRoomAction
  documentId String?        @map("document_id")
  folderId   String?        @map("folder_id")
  metadata   Json?
  ipAddress  String?        @map("ip_address")
  userAgent  String?        @map("user_agent")
  createdAt  DateTime       @default(now()) @map("created_at")
  dataRoom   DataRoom       @relation(fields: [dataRoomId], references: [id], onDelete: Cascade)

  @@index([dataRoomId, createdAt])
  @@index([dataRoomId, userId])
  @@index([documentId])
  @@index([documentId, userId])
  @@map("data_room_activities")
}

model DataRoomDocumentView {
  id            String           @id @default(cuid())
  documentId    String           @map("document_id")
  userId        String           @map("user_id")
  userEmail     String           @map("user_email")
  viewCount     Int              @default(1) @map("view_count")
  totalDuration Int              @default(0) @map("total_duration")
  lastViewedAt  DateTime         @default(now()) @map("last_viewed_at")
  createdAt     DateTime         @default(now()) @map("created_at")
  updatedAt     DateTime         @updatedAt @map("updated_at")
  document      DataRoomDocument @relation(fields: [documentId], references: [id], onDelete: Cascade)

  @@unique([documentId, userId])
  @@index([documentId])
  @@map("data_room_document_views")
}

model DataRoomQuestion {
  id            String           @id @default(cuid())
  dataRoomId    String           @map("data_room_id")
  documentId    String?          @map("document_id")
  folderId      String?          @map("folder_id")
  question      String
  askedByEmail  String           @map("asked_by_email")
  askedByUserId String?          @map("asked_by_user_id")
  status        String           @default("open")
  createdAt     DateTime         @default(now()) @map("created_at")
  updatedAt     DateTime         @updatedAt @map("updated_at")
  answers       DataRoomAnswer[]
  dataRoom      DataRoom         @relation(fields: [dataRoomId], references: [id], onDelete: Cascade)

  @@index([dataRoomId, status])
  @@map("data_room_questions")
}

model DataRoomAnswer {
  id               String           @id @default(cuid())
  questionId       String           @map("question_id")
  answer           String
  answeredByEmail  String           @map("answered_by_email")
  answeredByUserId String?          @map("answered_by_user_id")
  isInternal       Boolean          @default(false) @map("is_internal")
  createdAt        DateTime         @default(now()) @map("created_at")
  updatedAt        DateTime         @updatedAt @map("updated_at")
  question         DataRoomQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@index([questionId])
  @@map("data_room_answers")
}

model DataRoomNotification {
  id              String    @id @default(cuid())
  dataRoomId      String    @map("data_room_id")
  recipientUserId String    @map("recipient_user_id")
  type            String
  documentId      String?   @map("document_id")
  questionId      String?   @map("question_id")
  folderId        String?   @map("folder_id")
  title           String
  message         String
  actorEmail      String    @map("actor_email")
  actorUserId     String?   @map("actor_user_id")
  isRead          Boolean   @default(false) @map("is_read")
  readAt          DateTime? @map("read_at")
  createdAt       DateTime  @default(now()) @map("created_at")
  dataRoom        DataRoom  @relation(fields: [dataRoomId], references: [id], onDelete: Cascade)
  recipient       User      @relation("NotificationRecipient", fields: [recipientUserId], references: [id], onDelete: Cascade)

  @@index([recipientUserId, isRead])
  @@index([dataRoomId])
  @@map("data_room_notifications")
}

model SystemSetting {
  id        String   @id @default(cuid())
  key       String   @unique
  value     Json
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("system_settings")
}

model Integration {
  id                  String               @id @default(cuid())
  companyId           String               @map("company_id")
  provider            IntegrationProvider
  accessToken         String               @map("access_token")
  refreshToken        String               @map("refresh_token")
  tokenExpiresAt      DateTime             @map("token_expires_at")
  realmId             String?              @map("realm_id")
  providerCompanyName String?              @map("provider_company_name")
  autoSyncEnabled     Boolean              @default(true) @map("auto_sync_enabled")
  lastSyncAt          DateTime?            @map("last_sync_at")
  lastSyncStatus      SyncStatus           @default(IDLE) @map("last_sync_status")
  lastSyncError       String?              @map("last_sync_error")
  connectedAt         DateTime             @default(now()) @map("connected_at")
  disconnectedAt      DateTime?            @map("disconnected_at")
  createdAt           DateTime             @default(now()) @map("created_at")
  updatedAt           DateTime             @updatedAt @map("updated_at")
  syncLogs            IntegrationSyncLog[]
  company             Company              @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, provider])
  @@index([companyId])
  @@map("integrations")
}

model IntegrationSyncLog {
  id             String      @id @default(cuid())
  integrationId  String      @map("integration_id")
  syncType       String      @map("sync_type")
  status         SyncStatus
  startedAt      DateTime    @default(now()) @map("started_at")
  completedAt    DateTime?   @map("completed_at")
  periodsCreated Int         @default(0) @map("periods_created")
  periodsUpdated Int         @default(0) @map("periods_updated")
  errorMessage   String?     @map("error_message")
  errorDetails   Json?       @map("error_details")
  integration    Integration @relation(fields: [integrationId], references: [id], onDelete: Cascade)

  @@index([integrationId, startedAt])
  @@map("integration_sync_logs")
}

model FinancialPeriod {
  id                String             @id @default(cuid())
  companyId         String             @map("company_id")
  periodType        PeriodType         @map("period_type")
  fiscalYear        Int                @map("fiscal_year")
  quarter           Quarter?
  month             Int?
  startDate         DateTime           @map("start_date")
  endDate           DateTime           @map("end_date")
  label             String?
  createdAt         DateTime           @default(now()) @map("created_at")
  updatedAt         DateTime           @updatedAt @map("updated_at")
  balanceSheet      BalanceSheet?
  cashFlowStatement CashFlowStatement?
  adjustments       EbitdaAdjustment[]
  company           Company            @relation(fields: [companyId], references: [id], onDelete: Cascade)
  incomeStatement   IncomeStatement?

  @@unique([companyId, fiscalYear, periodType, quarter, month])
  @@index([companyId, fiscalYear])
  @@map("financial_periods")
}

model IncomeStatement {
  id                String          @id @default(cuid())
  periodId          String          @unique @map("period_id")
  grossRevenue      Decimal         @map("gross_revenue") @db.Decimal(15, 2)
  cogs              Decimal         @db.Decimal(15, 2)
  operatingExpenses Decimal         @map("operating_expenses") @db.Decimal(15, 2)
  grossProfit       Decimal         @map("gross_profit") @db.Decimal(15, 2)
  grossMarginPct    Decimal         @map("gross_margin_pct") @db.Decimal(5, 4)
  ebitda            Decimal         @db.Decimal(15, 2)
  ebitdaMarginPct   Decimal         @map("ebitda_margin_pct") @db.Decimal(5, 4)
  depreciation      Decimal?        @db.Decimal(15, 2)
  amortization      Decimal?        @db.Decimal(15, 2)
  interestExpense   Decimal?        @map("interest_expense") @db.Decimal(15, 2)
  taxExpense        Decimal?        @map("tax_expense") @db.Decimal(15, 2)
  createdAt         DateTime        @default(now()) @map("created_at")
  updatedAt         DateTime        @updatedAt @map("updated_at")
  period            FinancialPeriod @relation(fields: [periodId], references: [id], onDelete: Cascade)

  @@map("income_statements")
}

model BalanceSheet {
  id                       String          @id @default(cuid())
  periodId                 String          @unique @map("period_id")
  cash                     Decimal         @db.Decimal(15, 2)
  accountsReceivable       Decimal         @map("accounts_receivable") @db.Decimal(15, 2)
  inventory                Decimal         @db.Decimal(15, 2)
  prepaidExpenses          Decimal         @map("prepaid_expenses") @db.Decimal(15, 2)
  otherCurrentAssets       Decimal         @map("other_current_assets") @db.Decimal(15, 2)
  ppeGross                 Decimal         @map("ppe_gross") @db.Decimal(15, 2)
  accumulatedDepreciation  Decimal         @map("accumulated_depreciation") @db.Decimal(15, 2)
  intangibleAssets         Decimal         @map("intangible_assets") @db.Decimal(15, 2)
  otherLongTermAssets      Decimal         @map("other_long_term_assets") @db.Decimal(15, 2)
  accountsPayable          Decimal         @map("accounts_payable") @db.Decimal(15, 2)
  accruedExpenses          Decimal         @map("accrued_expenses") @db.Decimal(15, 2)
  currentPortionLtd        Decimal         @map("current_portion_ltd") @db.Decimal(15, 2)
  otherCurrentLiabilities  Decimal         @map("other_current_liabilities") @db.Decimal(15, 2)
  longTermDebt             Decimal         @map("long_term_debt") @db.Decimal(15, 2)
  deferredTaxLiabilities   Decimal         @map("deferred_tax_liabilities") @db.Decimal(15, 2)
  otherLongTermLiabilities Decimal         @map("other_long_term_liabilities") @db.Decimal(15, 2)
  retainedEarnings         Decimal         @map("retained_earnings") @db.Decimal(15, 2)
  ownersEquity             Decimal         @map("owners_equity") @db.Decimal(15, 2)
  totalCurrentAssets       Decimal         @map("total_current_assets") @db.Decimal(15, 2)
  totalLongTermAssets      Decimal         @map("total_long_term_assets") @db.Decimal(15, 2)
  totalAssets              Decimal         @map("total_assets") @db.Decimal(15, 2)
  totalCurrentLiabilities  Decimal         @map("total_current_liabilities") @db.Decimal(15, 2)
  totalLongTermLiabilities Decimal         @map("total_long_term_liabilities") @db.Decimal(15, 2)
  totalLiabilities         Decimal         @map("total_liabilities") @db.Decimal(15, 2)
  totalEquity              Decimal         @map("total_equity") @db.Decimal(15, 2)
  workingCapital           Decimal         @map("working_capital") @db.Decimal(15, 2)
  createdAt                DateTime        @default(now()) @map("created_at")
  updatedAt                DateTime        @updatedAt @map("updated_at")
  period                   FinancialPeriod @relation(fields: [periodId], references: [id], onDelete: Cascade)

  @@map("balance_sheets")
}

model CashFlowStatement {
  id                               String          @id @default(cuid())
  periodId                         String          @unique @map("period_id")
  priorPeriodId                    String?         @map("prior_period_id")
  netIncome                        Decimal         @map("net_income") @db.Decimal(15, 2)
  depreciation                     Decimal         @db.Decimal(15, 2)
  amortization                     Decimal         @db.Decimal(15, 2)
  changeInAccountsReceivable       Decimal         @map("change_in_accounts_receivable") @db.Decimal(15, 2)
  changeInInventory                Decimal         @map("change_in_inventory") @db.Decimal(15, 2)
  changeInPrepaidExpenses          Decimal         @map("change_in_prepaid_expenses") @db.Decimal(15, 2)
  changeInOtherCurrentAssets       Decimal         @map("change_in_other_current_assets") @db.Decimal(15, 2)
  changeInAccountsPayable          Decimal         @map("change_in_accounts_payable") @db.Decimal(15, 2)
  changeInAccruedExpenses          Decimal         @map("change_in_accrued_expenses") @db.Decimal(15, 2)
  changeInOtherCurrentLiabilities  Decimal         @map("change_in_other_current_liabilities") @db.Decimal(15, 2)
  changeInDeferredTaxLiabilities   Decimal         @map("change_in_deferred_tax_liabilities") @db.Decimal(15, 2)
  otherOperatingAdjustments        Decimal         @default(0) @map("other_operating_adjustments") @db.Decimal(15, 2)
  cashFromOperations               Decimal         @map("cash_from_operations") @db.Decimal(15, 2)
  capitalExpenditures              Decimal         @map("capital_expenditures") @db.Decimal(15, 2)
  changeInIntangibleAssets         Decimal         @map("change_in_intangible_assets") @db.Decimal(15, 2)
  changeInOtherLongTermAssets      Decimal         @map("change_in_other_long_term_assets") @db.Decimal(15, 2)
  otherInvestingActivities         Decimal         @default(0) @map("other_investing_activities") @db.Decimal(15, 2)
  cashFromInvesting                Decimal         @map("cash_from_investing") @db.Decimal(15, 2)
  changeInCurrentPortionLtd        Decimal         @map("change_in_current_portion_ltd") @db.Decimal(15, 2)
  changeInLongTermDebt             Decimal         @map("change_in_long_term_debt") @db.Decimal(15, 2)
  changeInOtherLongTermLiabilities Decimal         @map("change_in_other_long_term_liabilities") @db.Decimal(15, 2)
  changeInOwnersEquity             Decimal         @map("change_in_owners_equity") @db.Decimal(15, 2)
  otherFinancingActivities         Decimal         @default(0) @map("other_financing_activities") @db.Decimal(15, 2)
  cashFromFinancing                Decimal         @map("cash_from_financing") @db.Decimal(15, 2)
  netChangeInCash                  Decimal         @map("net_change_in_cash") @db.Decimal(15, 2)
  beginningCash                    Decimal         @map("beginning_cash") @db.Decimal(15, 2)
  endingCash                       Decimal         @map("ending_cash") @db.Decimal(15, 2)
  freeCashFlow                     Decimal         @map("free_cash_flow") @db.Decimal(15, 2)
  createdAt                        DateTime        @default(now()) @map("created_at")
  updatedAt                        DateTime        @updatedAt @map("updated_at")
  period                           FinancialPeriod @relation(fields: [periodId], references: [id], onDelete: Cascade)

  @@map("cash_flow_statements")
}

model DCFAssumptions {
  id                  String   @id @default(cuid())
  companyId           String   @unique @map("company_id")
  riskFreeRate        Decimal  @map("risk_free_rate") @db.Decimal(5, 4)
  marketRiskPremium   Decimal  @map("market_risk_premium") @db.Decimal(5, 4)
  beta                Decimal  @db.Decimal(4, 2)
  sizeRiskPremium     Decimal  @map("size_risk_premium") @db.Decimal(5, 4)
  costOfDebtOverride  Decimal? @map("cost_of_debt_override") @db.Decimal(5, 4)
  taxRateOverride     Decimal? @map("tax_rate_override") @db.Decimal(5, 4)
  growthAssumptions   Json     @map("growth_assumptions")
  terminalMethod      String   @map("terminal_method")
  perpetualGrowthRate Decimal  @map("perpetual_growth_rate") @db.Decimal(5, 4)
  exitMultiple        Decimal? @map("exit_multiple") @db.Decimal(4, 2)
  calculatedWACC      Decimal? @map("calculated_wacc") @db.Decimal(5, 4)
  enterpriseValue     Decimal? @map("enterprise_value") @db.Decimal(15, 2)
  equityValue         Decimal? @map("equity_value") @db.Decimal(15, 2)
  useDCFValue         Boolean  @default(false) @map("use_dcf_value") // When true, scorecard uses DCF value instead of EBITDA multiple
  createdAt           DateTime @default(now()) @map("created_at")
  updatedAt           DateTime @updatedAt @map("updated_at")
  company             Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@map("dcf_assumptions")
}

model ProjectQuestion {
  id                 String                      @id @default(cuid())
  moduleId           String                      @unique @map("module_id")
  questionId         String                      @unique @map("question_id")
  questionText       String                      @map("question_text")
  briCategory        BriCategory                 @map("bri_category")
  subCategory        String                      @map("sub_category")
  questionImpact     QuestionImpact              @map("question_impact")
  buyerSensitivity   BuyerSensitivity            @map("buyer_sensitivity")
  definitionNote     String?                     @map("definition_note")
  helpText           String?                     @map("help_text")
  riskDefinition     String?                     @map("risk_definition")
  primaryValueLever  String?                     @map("primary_value_lever")
  relatedQuestionIds String[]                    @map("related_question_ids")
  relatedModules     String[]                    @map("related_modules")
  isActive           Boolean                     @default(true) @map("is_active")
  createdAt          DateTime                    @default(now()) @map("created_at")
  updatedAt          DateTime                    @updatedAt @map("updated_at")
  companyPriorities  CompanyQuestionPriority[]
  assessmentLinks    ProjectAssessmentQuestion[]
  responses          ProjectAssessmentResponse[]
  options            ProjectQuestionOption[]
  strategies         ProjectStrategy[]

  @@index([briCategory, questionImpact])
  @@map("project_questions")
}

model ProjectQuestionOption {
  id                  String                      @id @default(cuid())
  questionId          String                      @map("question_id")
  optionId            String                      @map("option_id")
  optionText          String                      @map("option_text")
  scoreValue          Decimal                     @map("score_value") @db.Decimal(3, 2)
  buyerInterpretation String?                     @map("buyer_interpretation")
  displayOrder        Int                         @map("display_order")
  effectiveResponses  ProjectAssessmentResponse[] @relation("EffectiveProjectOption")
  selectedResponses   ProjectAssessmentResponse[] @relation("SelectedProjectOption")
  question            ProjectQuestion             @relation(fields: [questionId], references: [id], onDelete: Cascade)
  tasksUpgradingFrom  ProjectTaskTemplate[]       @relation("ProjectTaskUpgradeFrom")
  tasksUpgradingTo    ProjectTaskTemplate[]       @relation("ProjectTaskUpgradeTo")

  @@unique([questionId, optionId])
  @@map("project_question_options")
}

model ProjectStrategy {
  id                  String                @id @default(cuid())
  questionId          String                @map("question_id")
  strategyId          String                @map("strategy_id")
  strategyName        String                @map("strategy_name")
  strategyDescription String?               @map("strategy_description")
  strategyType        StrategyType          @map("strategy_type")
  upgradeFromScore    Decimal               @map("upgrade_from_score") @db.Decimal(3, 2)
  maxScoreAchievable  Decimal               @map("max_score_achievable") @db.Decimal(3, 2)
  estimatedEffort     String                @map("estimated_effort")
  estimatedTimeline   String?               @map("estimated_timeline")
  applicableWhen      String?               @map("applicable_when")
  question            ProjectQuestion       @relation(fields: [questionId], references: [id], onDelete: Cascade)
  taskTemplates       ProjectTaskTemplate[]

  @@unique([questionId, strategyId])
  @@map("project_strategies")
}

model ProjectTaskTemplate {
  id                   String                 @id @default(cuid())
  strategyId           String                 @map("strategy_id")
  taskId               String                 @map("task_id")
  sequence             Int
  title                String
  primaryVerb          String                 @map("primary_verb")
  verbTier             Int                    @map("verb_tier")
  object               String
  outcome              String?
  ownerRole            OwnerRole              @map("owner_role")
  timebox              Timebox
  effortLevel          EffortLevel            @map("effort_level")
  complexity           ComplexityLevel
  estimatedHours       Int?                   @map("estimated_hours")
  deliverables         String[]
  evidence             String[]
  riskCategory         BriCategory            @map("risk_category")
  dependencies         String[]
  blockedBy            String[]               @map("blocked_by")
  upgradesFromScore    Decimal?               @map("upgrades_from_score") @db.Decimal(3, 2)
  upgradesToScore      Decimal?               @map("upgrades_to_score") @db.Decimal(3, 2)
  upgradesFromOptionId String?                @map("upgrades_from_option_id")
  upgradesToOptionId   String?                @map("upgrades_to_option_id")
  deferReasonCode      String?                @map("defer_reason_code")
  companionVerbs       String[]               @map("companion_verbs")
  reEvaluationDate     String?                @map("re_evaluation_date")
  valueImpactState     String?                @map("value_impact_state")
  mitigationSummary    String?                @map("mitigation_summary")
  strategy             ProjectStrategy        @relation(fields: [strategyId], references: [id], onDelete: Cascade)
  upgradesFromOption   ProjectQuestionOption? @relation("ProjectTaskUpgradeFrom", fields: [upgradesFromOptionId], references: [id])
  upgradesToOption     ProjectQuestionOption? @relation("ProjectTaskUpgradeTo", fields: [upgradesToOptionId], references: [id])

  @@unique([strategyId, taskId])
  @@map("project_task_templates")
}

model ProjectAssessment {
  id                  String                      @id @default(cuid())
  companyId           String                      @map("company_id")
  assessmentNumber    Int                         @map("assessment_number")
  primaryCategory     BriCategory?                @map("primary_category")
  title               String?
  status              ProjectAssessmentStatus     @default(IN_PROGRESS)
  startedAt           DateTime                    @default(now()) @map("started_at")
  completedAt         DateTime?                   @map("completed_at")
  briScoreBefore      Decimal?                    @map("bri_score_before") @db.Decimal(5, 4)
  briScoreAfter       Decimal?                    @map("bri_score_after") @db.Decimal(5, 4)
  scoreImpact         Decimal?                    @map("score_impact") @db.Decimal(5, 4)
  actionPlanGenerated Boolean                     @default(false) @map("action_plan_generated")
  createdAt           DateTime                    @default(now()) @map("created_at")
  updatedAt           DateTime                    @updatedAt @map("updated_at")
  questions           ProjectAssessmentQuestion[]
  responses           ProjectAssessmentResponse[]
  company             Company                     @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@unique([companyId, assessmentNumber])
  @@index([companyId, status])
  @@map("project_assessments")
}

model ProjectAssessmentQuestion {
  id              String            @id @default(cuid())
  assessmentId    String            @map("assessment_id")
  questionId      String            @map("question_id")
  displayOrder    Int               @map("display_order")
  selectionReason String?           @map("selection_reason")
  priorityScore   Decimal           @map("priority_score") @db.Decimal(5, 2)
  skipped         Boolean           @default(false)
  skippedAt       DateTime?         @map("skipped_at")
  assessment      ProjectAssessment @relation(fields: [assessmentId], references: [id], onDelete: Cascade)
  question        ProjectQuestion   @relation(fields: [questionId], references: [id])

  @@unique([assessmentId, questionId])
  @@map("project_assessment_questions")
}

model ProjectAssessmentResponse {
  id                String                 @id @default(cuid())
  assessmentId      String                 @map("assessment_id")
  questionId        String                 @map("question_id")
  selectedOptionId  String                 @map("selected_option_id")
  effectiveOptionId String?                @map("effective_option_id")
  estimatedScore    Decimal?               @map("estimated_score") @db.Decimal(3, 2)
  actualScore       Decimal                @map("actual_score") @db.Decimal(3, 2)
  scoreImpact       Decimal?               @map("score_impact") @db.Decimal(4, 3)
  confidenceLevel   ConfidenceLevel        @map("confidence_level")
  notes             String?
  evidenceUrls      String[]               @map("evidence_urls")
  createdAt         DateTime               @default(now()) @map("created_at")
  updatedAt         DateTime               @updatedAt @map("updated_at")
  assessment        ProjectAssessment      @relation(fields: [assessmentId], references: [id], onDelete: Cascade)
  effectiveOption   ProjectQuestionOption? @relation("EffectiveProjectOption", fields: [effectiveOptionId], references: [id])
  question          ProjectQuestion        @relation(fields: [questionId], references: [id])
  selectedOption    ProjectQuestionOption  @relation("SelectedProjectOption", fields: [selectedOptionId], references: [id])

  @@unique([assessmentId, questionId])
  @@index([assessmentId, createdAt(sort: Desc)])
  @@map("project_assessment_responses")
}

model CompanyQuestionPriority {
  id             String          @id @default(cuid())
  companyId      String          @map("company_id")
  questionId     String          @map("question_id")
  impactScore    Decimal         @map("impact_score") @db.Decimal(5, 2)
  relevanceScore Decimal         @map("relevance_score") @db.Decimal(5, 2)
  urgencyScore   Decimal         @map("urgency_score") @db.Decimal(5, 2)
  priorityScore  Decimal         @map("priority_score") @db.Decimal(5, 2)
  hasBeenAsked   Boolean         @default(false) @map("has_been_asked")
  askedAt        DateTime?       @map("asked_at")
  updatedAt      DateTime        @updatedAt @map("updated_at")
  company        Company         @relation(fields: [companyId], references: [id], onDelete: Cascade)
  question       ProjectQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@unique([companyId, questionId])
  @@index([companyId, priorityScore])
  @@map("company_question_priorities")
}

model UserConsent {
  id          String        @id @default(cuid())
  userId      String        @map("user_id")
  consentType ConsentType   @map("consent_type")
  action      ConsentAction
  version     String?
  ipAddress   String?       @map("ip_address")
  userAgent   String?       @map("user_agent")
  createdAt   DateTime      @default(now()) @map("created_at")
  user        User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, consentType])
  @@index([userId, createdAt])
  @@map("user_consents")
}

model DataDeletionRequest {
  id                String                @id @default(cuid())
  userId            String                @map("user_id")
  status            DeletionRequestStatus @default(PENDING)
  reason            String?
  requestedAt       DateTime              @default(now()) @map("requested_at")
  scheduledFor      DateTime              @map("scheduled_for")
  processedAt       DateTime?             @map("processed_at")
  cancelledAt       DateTime?             @map("cancelled_at")
  confirmationToken String                @unique @map("confirmation_token")
  confirmedAt       DateTime?             @map("confirmed_at")
  dataDeleted       Json?                 @map("data_deleted")
  deletedBy         String?               @map("deleted_by")
  user              User                  @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, status])
  @@index([status, scheduledFor])
  @@map("data_deletion_requests")
}

model DataExportRequest {
  id                 String              @id @default(cuid())
  userId             String              @map("user_id")
  status             ExportRequestStatus @default(PENDING)
  requestedAt        DateTime            @default(now()) @map("requested_at")
  processedAt        DateTime?           @map("processed_at")
  downloadedAt       DateTime?           @map("downloaded_at")
  expiresAt          DateTime?           @map("expires_at")
  filePath           String?             @map("file_path")
  fileSize           Int?                @map("file_size")
  downloadToken      String?             @unique @map("download_token")
  downloadCount      Int                 @default(0) @map("download_count")
  includeProfile     Boolean             @default(true) @map("include_profile")
  includeCompanies   Boolean             @default(true) @map("include_companies")
  includeAssessments Boolean             @default(true) @map("include_assessments")
  includeDocuments   Boolean             @default(false) @map("include_documents")
  errorMessage       String?             @map("error_message")
  user               User                @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, status])
  @@index([downloadToken])
  @@map("data_export_requests")
}

model AuditLog {
  id         String   @id @default(cuid())
  actorId    String   @map("actor_id")
  actorEmail String   @map("actor_email")
  action     String
  targetType String   @map("target_type")
  targetId   String?  @map("target_id")
  metadata   Json?
  ipAddress  String?  @map("ip_address")
  userAgent  String?  @map("user_agent")
  createdAt  DateTime @default(now()) @map("created_at")
  actor      User     @relation("AuditActor", fields: [actorId], references: [id])

  @@index([actorId])
  @@index([targetType, targetId])
  @@index([action])
  @@index([createdAt])
  @@map("audit_logs")
}

model ImpersonationSession {
  id           String    @id @default(cuid())
  adminId      String    @map("admin_id")
  targetUserId String    @map("target_user_id")
  reason       String
  startedAt    DateTime  @default(now()) @map("started_at")
  endedAt      DateTime? @map("ended_at")
  ipAddress    String?   @map("ip_address")
  admin        User      @relation("ImpersonationAdmin", fields: [adminId], references: [id])
  targetUser   User      @relation("ImpersonationTarget", fields: [targetUserId], references: [id])

  @@index([adminId])
  @@index([targetUserId])
  @@map("impersonation_sessions")
}

model SupportTicket {
  id           String          @id @default(cuid())
  ticketNumber String          @unique @map("ticket_number")
  userId       String?         @map("user_id")
  userEmail    String          @map("user_email")
  subject      String
  status       String          @default("open")
  priority     String          @default("normal")
  category     String?
  assignedToId String?         @map("assigned_to_id")
  createdAt    DateTime        @default(now()) @map("created_at")
  updatedAt    DateTime        @updatedAt @map("updated_at")
  resolvedAt   DateTime?       @map("resolved_at")
  assignedTo   User?           @relation("TicketAssignee", fields: [assignedToId], references: [id])
  user         User?           @relation("TicketUser", fields: [userId], references: [id])
  messages     TicketMessage[]

  @@index([userId])
  @@index([status])
  @@index([assignedToId])
  @@map("support_tickets")
}

model TicketMessage {
  id          String        @id @default(cuid())
  ticketId    String        @map("ticket_id")
  authorId    String?       @map("author_id")
  authorEmail String        @map("author_email")
  content     String
  isInternal  Boolean       @default(false) @map("is_internal")
  createdAt   DateTime      @default(now()) @map("created_at")
  author      User?         @relation(fields: [authorId], references: [id])
  ticket      SupportTicket @relation(fields: [ticketId], references: [id], onDelete: Cascade)

  @@index([ticketId])
  @@map("ticket_messages")
}

model ProspectiveBuyer {
  id               String             @id @default(cuid())
  companyId        String             @map("company_id")
  name             String
  buyerType        BuyerType          @map("buyer_type")
  tier             BuyerTier          @default(B_TIER)
  website          String?
  description      String?
  industry         String?
  location         String?
  currentStage     DealStage          @default(IDENTIFIED) @map("current_stage")
  stageUpdatedAt   DateTime           @default(now()) @map("stage_updated_at")
  approvedAt       DateTime?          @map("approved_at")
  ndaExecutedAt    DateTime?          @map("nda_executed_at")
  ioiReceivedAt    DateTime?          @map("ioi_received_at")
  loiReceivedAt    DateTime?          @map("loi_received_at")
  closedAt         DateTime?          @map("closed_at")
  withdrawnAt      DateTime?          @map("withdrawn_at")
  approvalStatus   String?            @map("approval_status")
  approvalNotes    String?            @map("approval_notes")
  approvalById     String?            @map("approval_by_id")
  ioiAmount        Decimal?           @map("ioi_amount") @db.Decimal(15, 2)
  loiAmount        Decimal?           @map("loi_amount") @db.Decimal(15, 2)
  ioiDeadline      DateTime?          @map("ioi_deadline")
  loiDeadline      DateTime?          @map("loi_deadline")
  exclusivityStart DateTime?          @map("exclusivity_start")
  exclusivityEnd   DateTime?          @map("exclusivity_end")
  internalNotes    String?            @map("internal_notes")
  tags             String[]
  createdById      String             @map("created_by_id")
  createdAt        DateTime           @default(now()) @map("created_at")
  updatedAt        DateTime           @updatedAt @map("updated_at")
  prospectId       String?            @map("prospect_id")
  contacts         BuyerContact[]
  activities       DealActivity[]
  documents        DealDocument[]
  meetings         DealMeeting[]
  stageHistory     DealStageHistory[]
  company          Company            @relation(fields: [companyId], references: [id], onDelete: Cascade)
  prospect         BuyerProspect?     @relation(fields: [prospectId], references: [id])

  @@unique([companyId, name])
  @@index([companyId, currentStage])
  @@index([prospectId])
  @@map("prospective_buyers")
}

model BuyerContact {
  id               String           @id @default(cuid())
  buyerId          String           @map("buyer_id")
  email            String
  firstName        String           @map("first_name")
  lastName         String           @map("last_name")
  title            String?
  phone            String?
  role             BuyerContactRole @default(DEAL_LEAD)
  isPrimary        Boolean          @default(false) @map("is_primary")
  dataRoomAccessId String?          @unique @map("data_room_access_id")
  isActive         Boolean          @default(true) @map("is_active")
  createdAt        DateTime         @default(now()) @map("created_at")
  updatedAt        DateTime         @updatedAt @map("updated_at")
  buyer            ProspectiveBuyer @relation(fields: [buyerId], references: [id], onDelete: Cascade)
  dataRoomAccess   DataRoomAccess?  @relation(fields: [dataRoomAccessId], references: [id])

  @@unique([buyerId, email])
  @@index([buyerId])
  @@map("buyer_contacts")
}

model DealStageHistory {
  id          String           @id @default(cuid())
  buyerId     String           @map("buyer_id")
  fromStage   DealStage?       @map("from_stage")
  toStage     DealStage        @map("to_stage")
  notes       String?
  changedById String           @map("changed_by_id")
  changedAt   DateTime         @default(now()) @map("changed_at")
  buyer       ProspectiveBuyer @relation(fields: [buyerId], references: [id], onDelete: Cascade)

  @@index([buyerId, changedAt])
  @@map("deal_stage_history")
}

model DealActivity {
  id            String           @id @default(cuid())
  buyerId       String           @map("buyer_id")
  activityType  String           @map("activity_type")
  description   String
  metadata      Json?
  performedById String?          @map("performed_by_id")
  performedAt   DateTime         @default(now()) @map("performed_at")
  buyer         ProspectiveBuyer @relation(fields: [buyerId], references: [id], onDelete: Cascade)

  @@index([buyerId, performedAt])
  @@map("deal_activities")
}

model DealDocument {
  id           String           @id @default(cuid())
  buyerId      String           @map("buyer_id")
  documentType DealDocumentType @map("document_type")
  name         String
  description  String?
  filePath     String?          @map("file_path")
  fileName     String?          @map("file_name")
  fileSize     Int?             @map("file_size")
  mimeType     String?          @map("mime_type")
  receivedAt   DateTime?        @map("received_at")
  sentAt       DateTime?        @map("sent_at")
  uploadedById String           @map("uploaded_by_id")
  createdAt    DateTime         @default(now()) @map("created_at")
  updatedAt    DateTime         @updatedAt @map("updated_at")
  buyer        ProspectiveBuyer @relation(fields: [buyerId], references: [id], onDelete: Cascade)

  @@index([buyerId, documentType])
  @@map("deal_documents")
}

model DealMeeting {
  id          String           @id @default(cuid())
  buyerId     String           @map("buyer_id")
  meetingType MeetingType      @map("meeting_type")
  title       String
  description String?
  scheduledAt DateTime         @map("scheduled_at")
  duration    Int?
  location    String?
  meetingLink String?          @map("meeting_link")
  status      String           @default("scheduled")
  completedAt DateTime?        @map("completed_at")
  notes       String?
  attendees   Json?
  createdById String           @map("created_by_id")
  createdAt   DateTime         @default(now()) @map("created_at")
  updatedAt   DateTime         @updatedAt @map("updated_at")
  buyer       ProspectiveBuyer @relation(fields: [buyerId], references: [id], onDelete: Cascade)

  @@index([buyerId, scheduledAt])
  @@map("deal_meetings")
}

model BuyerProspect {
  id                   String                 @id @default(cuid())
  companyId            String                 @map("company_id")
  name                 String
  domain               String?
  website              String?
  headquartersLocation String?                @map("headquarters_location")
  buyerType            BuyerType              @map("buyer_type")
  relevanceDescription String?                @map("relevance_description")
  approvalStatus       ProspectApprovalStatus @default(UNDECIDED) @map("approval_status")
  statusChangedAt      DateTime?              @map("status_changed_at")
  statusChangedBy      String?                @map("status_changed_by")
  denialReason         String?                @map("denial_reason")
  source               ProspectSource         @default(MANUAL)
  importBatchId        String?                @map("import_batch_id")
  notes                String?
  createdAt            DateTime               @default(now()) @map("created_at")
  updatedAt            DateTime               @updatedAt @map("updated_at")
  createdById          String                 @map("created_by_id")
  company              Company                @relation(fields: [companyId], references: [id], onDelete: Cascade)
  importBatch          ProspectImportBatch?   @relation(fields: [importBatchId], references: [id])
  buyers               ProspectiveBuyer[]

  @@unique([companyId, name])
  @@index([companyId, approvalStatus])
  @@index([domain])
  @@map("buyer_prospects")
}

model ProspectImportBatch {
  id             String          @id @default(cuid())
  companyId      String          @map("company_id")
  filename       String?
  totalRows      Int             @default(0) @map("total_rows")
  successfulRows Int             @default(0) @map("successful_rows")
  failedRows     Int             @default(0) @map("failed_rows")
  errorLog       Json?           @map("error_log")
  status         String          @default("processing")
  createdAt      DateTime        @default(now()) @map("created_at")
  createdById    String          @map("created_by_id")
  prospects      BuyerProspect[]
  company        Company         @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId])
  @@map("prospect_import_batches")
}

// ============================================
// Company Ownership & Access Models
// ============================================

model CompanyOwnership {
  id                 String              @id @default(cuid())
  companyId          String              @map("company_id")
  userId             String              @map("user_id")
  ownershipPercent   Decimal?            @map("ownership_percent") @db.Decimal(5, 2)
  isSubscribingOwner Boolean             @default(false) @map("is_subscribing_owner")
  invitedById        String?             @map("invited_by_id")
  status             CompanyMemberStatus @default(ACTIVE)
  createdAt          DateTime            @default(now()) @map("created_at")
  company            Company             @relation(fields: [companyId], references: [id], onDelete: Cascade)
  user               User                @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([companyId, userId])
  @@index([userId])
  @@map("company_ownerships")
}

model CompanyStaffAccess {
  id                  String              @id @default(cuid())
  companyId           String              @map("company_id")
  userId              String              @map("user_id")
  invitedById         String              @map("invited_by_id")
  hasPFSAccess        Boolean             @default(false) @map("has_pfs_access")
  hasRetirementAccess Boolean             @default(false) @map("has_retirement_access")
  hasLoansAccess      Boolean             @default(false) @map("has_loans_access")
  status              CompanyMemberStatus @default(ACTIVE)
  createdAt           DateTime            @default(now()) @map("created_at")
  company             Company             @relation(fields: [companyId], references: [id], onDelete: Cascade)
  user                User                @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([companyId, userId])
  @@index([userId])
  @@map("company_staff_access")
}

model AccessRequest {
  id          String              @id @default(cuid())
  companyId   String              @map("company_id")
  requesterId String              @map("requester_id")
  ownerId     String              @map("owner_id")
  featureKey  String              @map("feature_key") // 'pfs' | 'retirement' | 'loans'
  status      AccessRequestStatus @default(PENDING)
  reason      String?
  respondedAt DateTime?           @map("responded_at")
  expiresAt   DateTime            @map("expires_at")
  createdAt   DateTime            @default(now()) @map("created_at")
  company     Company             @relation(fields: [companyId], references: [id], onDelete: Cascade)
  requester   User                @relation("AccessRequester", fields: [requesterId], references: [id], onDelete: Cascade)
  owner       User                @relation("AccessOwner", fields: [ownerId], references: [id], onDelete: Cascade)

  @@index([companyId, status])
  @@index([ownerId, status])
  @@index([requesterId])
  @@map("access_requests")
}

model Alert {
  id          String    @id @default(cuid())
  recipientId String    @map("recipient_id")
  type        AlertType
  title       String
  message     String
  actionUrl   String?   @map("action_url")
  metadata    Json?
  isRead      Boolean   @default(false) @map("is_read")
  readAt      DateTime? @map("read_at")
  createdAt   DateTime  @default(now()) @map("created_at")
  recipient   User      @relation(fields: [recipientId], references: [id], onDelete: Cascade)

  @@index([recipientId, isRead])
  @@index([recipientId, createdAt])
  @@map("alerts")
}

model CompanyInvite {
  id               String            @id @default(cuid())
  companyId        String            @map("company_id")
  email            String
  inviteType       CompanyInviteType @default(STAFF) @map("invite_type")
  ownershipPercent Decimal?          @map("ownership_percent") @db.Decimal(5, 2)
  invitedById      String            @map("invited_by_id")
  token            String            @unique @default(cuid())
  expiresAt        DateTime          @map("expires_at")
  acceptedAt       DateTime?         @map("accepted_at")
  createdAt        DateTime          @default(now()) @map("created_at")
  company          Company           @relation(fields: [companyId], references: [id], onDelete: Cascade)
  inviter          User              @relation("CompanyInviter", fields: [invitedById], references: [id])

  @@unique([companyId, email])
  @@index([token])
  @@map("company_invites")
}

enum UserRole {
  SUPER_ADMIN
  ADMIN
  TEAM_LEADER
  MEMBER
  VIEWER
}

enum FunctionalCategory {
  OWNER
  FINANCE
  OPERATIONS
  HR
  LEGAL
  SALES_MARKETING
  IT
  EXTERNAL
}

enum RevenueSizeCategory {
  UNDER_500K
  FROM_500K_TO_1M
  FROM_1M_TO_3M
  FROM_3M_TO_10M
  FROM_10M_TO_25M
  OVER_25M
}

enum RevenueModelType {
  PROJECT_BASED
  TRANSACTIONAL
  RECURRING_CONTRACTS
  SUBSCRIPTION_SAAS
}

enum GrossMarginCategory {
  LOW
  MODERATE
  GOOD
  EXCELLENT
}

enum LaborIntensityLevel {
  LOW
  MODERATE
  HIGH
  VERY_HIGH
}

enum AssetIntensityLevel {
  ASSET_LIGHT
  MODERATE
  ASSET_HEAVY
}

enum OwnerInvolvementLevel {
  MINIMAL
  LOW
  MODERATE
  HIGH
  CRITICAL
}

enum ConfidenceLevel {
  UNCERTAIN
  SOMEWHAT_CONFIDENT
  CONFIDENT
  VERIFIED
}

enum BriCategory {
  FINANCIAL
  TRANSFERABILITY
  OPERATIONAL
  MARKET
  LEGAL_TAX
  PERSONAL
}

enum ActionItemType {
  TYPE_I_EVIDENCE
  TYPE_II_DOCUMENTATION
  TYPE_III_OPERATIONAL
  TYPE_IV_INSTITUTIONALIZE
  TYPE_V_RISK_REDUCTION
  TYPE_VI_ALIGNMENT
  TYPE_VII_READINESS
  TYPE_VIII_SIGNALING
  TYPE_IX_OPTIONS
  TYPE_X_DEFER
}

enum EffortLevel {
  MINIMAL
  LOW
  MODERATE
  HIGH
  MAJOR
}

enum ComplexityLevel {
  SIMPLE
  MODERATE
  COMPLEX
  STRATEGIC
}

enum ImpactLevel {
  NONE
  LOW
  MEDIUM
  HIGH
  VERY_HIGH
}

enum DifficultyLevel {
  NONE
  LOW
  MEDIUM
  HIGH
  VERY_HIGH
}

enum TaskStatus {
  PENDING
  IN_PROGRESS
  BLOCKED
  COMPLETED
  DEFERRED
  CANCELLED
  NOT_APPLICABLE
}

enum SprintPriority {
  BIG_ROCK
  SAND
  WATER
}

enum SprintStatus {
  PLANNING
  ACTIVE
  COMPLETED
  CANCELLED
}

enum AssessmentType {
  INITIAL
  QUARTERLY_CHECK_IN
  AD_HOC
}

enum IssueTier {
  CRITICAL
  SIGNIFICANT
  OPTIMIZATION
}

enum PeriodType {
  ANNUAL
  QUARTERLY
  MONTHLY
}

enum Quarter {
  Q1
  Q2
  Q3
  Q4
}

enum QuestionImpact {
  CRITICAL
  HIGH
  MEDIUM
  LOW
}

enum BuyerSensitivity {
  CRITICAL
  HIGH
  MEDIUM
  LOW
}

enum StrategyType {
  FULL_FIX
  PARTIAL_MITIGATION
  RISK_ACCEPTANCE
}

enum OwnerRole {
  FOUNDER
  CFO_FINANCE
  OPS_LEADER
  SALES_MKTG
  HR_PEOPLE
  LEGAL_COMPLIANCE
  IT_SECURITY
  ADVISOR
}

enum Timebox {
  IMMEDIATE_0_30
  NEAR_30_90
  LONG_90_365
}

enum ProjectAssessmentStatus {
  IN_PROGRESS
  COMPLETED
  ABANDONED
}

enum DataRoomCategory {
  FINANCIAL
  LEGAL
  OPERATIONS
  CUSTOMERS
  EMPLOYEES
  IP
  CUSTOM
  TASK_PROOF
  TAX
  SALES_MARKETING
  TECHNOLOGY
  REAL_ESTATE
  ENVIRONMENTAL
  INSURANCE
  CORPORATE
}

enum DataRoomStage {
  PREPARATION
  TEASER
  POST_NDA
  DUE_DILIGENCE
  CLOSED
}

enum DataRoomAccessLevel {
  VIEWER
  DOWNLOADER
  CONTRIBUTOR
  ADMIN
}

enum DataRoomAction {
  VIEWED_FOLDER
  VIEWED_DOCUMENT
  DOWNLOADED_DOCUMENT
  UPLOADED_DOCUMENT
  DELETED_DOCUMENT
  UPDATED_DOCUMENT
  CREATED_FOLDER
  DELETED_FOLDER
  GRANTED_ACCESS
  REVOKED_ACCESS
  ASKED_QUESTION
  ANSWERED_QUESTION
  EXPORTED_REPORT
  STAGE_CHANGED
}

enum UpdateFrequency {
  MONTHLY
  QUARTERLY
  ANNUALLY
  AS_NEEDED
  ONE_TIME
}

enum DocumentStatus {
  CURRENT
  NEEDS_UPDATE
  OVERDUE
}

enum PlanTier {
  FOUNDATION
  GROWTH
  EXIT_READY
}

enum BillingCycle {
  MONTHLY
  ANNUAL
}

enum SubscriptionStatus {
  ACTIVE
  TRIALING
  PAST_DUE
  CANCELLED
  EXPIRED
}

enum IntegrationProvider {
  QUICKBOOKS_ONLINE
}

enum SyncStatus {
  IDLE
  SYNCING
  SUCCESS
  FAILED
}

enum ConsentType {
  TERMS_OF_SERVICE
  PRIVACY_POLICY
  MARKETING_EMAILS
  ANALYTICS_COOKIES
  FUNCTIONAL_COOKIES
  MARKETING_COOKIES
}

enum ConsentAction {
  GRANTED
  WITHDRAWN
  UPDATED
}

enum DeletionRequestStatus {
  PENDING
  PROCESSING
  COMPLETED
  CANCELLED
}

enum ExportRequestStatus {
  PENDING
  PROCESSING
  READY
  DOWNLOADED
  EXPIRED
  FAILED
}

enum DealStage {
  IDENTIFIED
  SELLER_REVIEWING
  APPROVED
  DECLINED
  TEASER_SENT
  INTERESTED
  PASSED
  NDA_SENT
  NDA_NEGOTIATING
  NDA_EXECUTED
  CIM_ACCESS
  LEVEL_2_ACCESS
  LEVEL_3_ACCESS
  MANAGEMENT_MEETING_SCHEDULED
  MANAGEMENT_MEETING_COMPLETED
  IOI_REQUESTED
  IOI_RECEIVED
  IOI_ACCEPTED
  IOI_DECLINED
  LOI_REQUESTED
  LOI_RECEIVED
  LOI_SELECTED
  LOI_BACKUP
  DUE_DILIGENCE
  PA_DRAFTING
  PA_NEGOTIATING
  CLOSING
  CLOSED
  WITHDRAWN
  TERMINATED
}

enum BuyerType {
  STRATEGIC
  FINANCIAL
  INDIVIDUAL
  MANAGEMENT
  ESOP
  OTHER
}

enum ProspectApprovalStatus {
  UNDECIDED
  APPROVED
  DENIED
}

enum ProspectSource {
  MANUAL
  CSV_IMPORT
}

enum BuyerTier {
  A_TIER
  B_TIER
  C_TIER
  D_TIER
}

enum BuyerContactRole {
  PRIMARY
  DECISION_MAKER
  DEAL_LEAD
  DILIGENCE
  LEGAL
  FINANCE
  OPERATIONS
}

enum DealDocumentType {
  TEASER
  NDA_TEMPLATE
  NDA_SIGNED
  CIM
  PROCESS_LETTER
  IOI_RECEIVED
  LOI_RECEIVED
  PURCHASE_AGREEMENT
  OTHER
}

enum MeetingType {
  INTRO_CALL
  MANAGEMENT_PRESENTATION
  SITE_VISIT
  EXPERT_SESSION
  NEGOTIATION
  OTHER
}

enum UserType {
  SUBSCRIBER
  GUEST
  COMPED
}

enum AccessRequestStatus {
  PENDING
  APPROVED
  DENIED
  EXPIRED
}

enum AlertType {
  ACCESS_REQUEST
  ACCESS_GRANTED
  ACCESS_DENIED
  STAFF_PAUSED
  OWNERSHIP_TRANSFER
  TRIAL_ENDING
  TRIAL_EXPIRED
}

enum CompanyMemberStatus {
  ACTIVE
  PAUSED
}

enum CompanyInviteType {
  STAFF
  GUEST_OWNER
}
